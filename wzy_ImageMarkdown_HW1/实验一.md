# **Chap1 基于VirtualBox的网络攻防基础环境搭建实例** #

----------
##**实验设备：**##
- 物理主机
- 虚拟机（靶机、网关、攻击者主机）
## **实验要求：** ##
- 靶机可以直接访问攻击者主机
- 攻击者主机无法直接访问靶机
- 网关可以直接访问攻击者主机和靶机
- 靶机的所有对外上下行流量必须经过网关
- 所有节点均可以访问互联网
- *所有节点制作成基础镜像（多重加载的虚拟硬盘）*
## **实验过程：** ##
- 设置基础镜像
> 将基础镜像设为多重加载


- *​	VBox: 管理->虚拟介质管理 释放虚拟介质 修改属性为多重加载；创建虚拟机，选择现有虚拟硬盘文件，选择响应虚拟硬盘。*


- 配置网卡
> 网关设置两个网卡，分别为NAT网络和桥接网络；靶机和攻击者主机只设置一块NAT网络网卡
- *NAT网络：类同VMware的NAT模式，除主机不能主动访问虚拟机。需要在全局网络配置中针对该NAT网络设置端口转发，主机与虚拟机才能有限度的互访。同一NAT网络中的虚拟机间能无限制互访。*

> 桥接网络连接外网，NAT网络为内部局域网，并启用DHCP服务

- 设置IP
> 网关的网卡1启用默认IP，靶机和攻击者主机IP需手动配置，且二者网关均设为网关主机网卡1的IP即10.0.2.4，网关网卡2的IP手动设为192.168.1.9

 
-局域网内单向访问
>  在靶机终端设置防火墙规则，以使攻击者主机无法直接访问靶机。

- 访问外网
> 在靶机和攻击者主机配置端口转发，使可以访问互联网
## **实验结果** ##
- 靶机可以ping通攻击者主机
- 攻击者主机不可以ping通靶机
- 网关可以ping通攻击者主机和靶机
- 网关接收到靶机所有对外流量（网关终端设置抓包命令）
    `tcpdump -i eth1 -n （开启抓包  -n表示不反向解析）`
- 访问外网
## **实验问题** ##
- 虽然配置了端口转发，但靶机和攻击者主机仍然不能访问外网，查阅了很多资料也做了相应更改均无效，不知在NAT网络下如何配置才可以访问外网
- 希望老师在下次课程中能对此次实验有所讲解和示范，帮助我们对实验过程及结果有更深的理解。




